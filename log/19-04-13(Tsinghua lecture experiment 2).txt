----------------------------------------------------------------------------------------------------
19-04-13 11:27:10
SEED = 1555126030
----------------------------------------------------------------------------------------------------
Options are printed as follows:
title = 'Tsinghua lecture experiment 2'
mode = 'train'  # 'train', 'test', 'restart', 'debug', 'export', 'input_train', 'input_test', 'speed_net'
seed = None
repeat = 1
delay = False  # start training after xxx minutes
gpu_list = [0]
batch_size = 128
interp = 0
dataset = 'fashion'  # 'mnist','svhn','cifar10', 'cifar100', 'imagenet', 'fashion'
preprocess = 'mnist'  # 'mnist', 'cifar', 'alexnet', 'inception_v2'
network = 'lenet'  # 'mlp', 'lenet', 'alexnet', 'densenet_test', 'resnet_test', 'mobilenet_v1', 'mobilenet_v2', shufflenet_v2
path_load = None
path_save = None   # None, False, True, or specify a dir
l2_decay = {'decay': 1e-4, 'exclude': ['depthwise']}
epoch_step = tf.Variable(1, name='epoch_step', trainable=False)
learning_step = tf.Variable(0, name='learning_step', trainable=False)
lr_decay = tf.train.cosine_decay(0.1, epoch_step, decay_steps=100)
loss_func = tf.losses.softmax_cross_entropy
optimizer = tf.train.MomentumOptimizer(lr_decay, 0.9, use_nesterov=True)
----------------------------------------------------------------------------------------------------
Single-GPU training with gpu 0
All parameters are pinned to GPU, all Ops are pinned to GPU
Training model on GPU 0
Perform input channel normalization in GPU for speed
No normalization in GPU for dataset fashion
Input data format is NHWC, convert to NCHW
/device:GPU:0 Conv0/conv0_1 [5, 5, 1, 32]
/device:GPU:0 Conv1/conv1_1 [5, 5, 32, 64]
/device:GPU:0 Fc0/fc0_1 [1024, 512]
/device:GPU:0 Fc1/fc1_1 [512, 10]
Parameters: 581408 {'fc': 529408, 'conv': 52000}
MACs: 4267008
MEMs: 11
Add L2 weight decay 0.0001 to following trainable variables:
['conv0/conv0_1', 'conv1/conv1_1', 'fc0/fc0_1', 'fc1/fc1_1']
Testing model on GPU 0
Perform input channel normalization in GPU for speed
No normalization in GPU for dataset fashion
Input data format is NHWC, convert to NCHW
----------------------------------------------------------------------------------------------------
Epoch: 001 Loss: 0.532695 Train: 0.1832 Test: 0.1294 lr: 0.1000 FPS: 29636 
Epoch: 002 Loss: 0.318777 Train: 0.1178 Test: 0.1149 lr: 0.0999 FPS: 54283 B 
Epoch: 003 Loss: 0.282052 Train: 0.1046 Test: 0.1115 lr: 0.0998 FPS: 55958 B 
Epoch: 004 Loss: 0.257107 Train: 0.0953 Test: 0.1093 lr: 0.0996 FPS: 54473 B 
Epoch: 005 Loss: 0.234976 Train: 0.0898 Test: 0.1092 lr: 0.0994 FPS: 55629 B 
Epoch: 006 Loss: 0.219796 Train: 0.0817 Test: 0.1047 lr: 0.0991 FPS: 55440 B 
Epoch: 007 Loss: 0.204392 Train: 0.0767 Test: 0.1026 lr: 0.0988 FPS: 55013 B 
Epoch: 008 Loss: 0.192798 Train: 0.0729 Test: 0.1029 lr: 0.0984 FPS: 55641 
Epoch: 009 Loss: 0.180052 Train: 0.0680 Test: 0.1061 lr: 0.0980 FPS: 55435 
Epoch: 010 Loss: 0.168524 Train: 0.0641 Test: 0.1023 lr: 0.0976 FPS: 55197 B 
Epoch: 011 Loss: 0.158173 Train: 0.0611 Test: 0.0982 lr: 0.0970 FPS: 55555 B 
Epoch: 012 Loss: 0.146620 Train: 0.0552 Test: 0.1039 lr: 0.0965 FPS: 55174 
Epoch: 013 Loss: 0.143179 Train: 0.0538 Test: 0.0987 lr: 0.0959 FPS: 55015 
Epoch: 014 Loss: 0.134800 Train: 0.0521 Test: 0.0996 lr: 0.0952 FPS: 55424 
Epoch: 015 Loss: 0.126640 Train: 0.0482 Test: 0.1027 lr: 0.0946 FPS: 55163 
Epoch: 016 Loss: 0.120777 Train: 0.0462 Test: 0.0978 lr: 0.0938 FPS: 55020 B 
Epoch: 017 Loss: 0.116065 Train: 0.0436 Test: 0.1012 lr: 0.0930 FPS: 55124 
Epoch: 018 Loss: 0.103317 Train: 0.0385 Test: 0.1021 lr: 0.0922 FPS: 55744 
Epoch: 019 Loss: 0.098815 Train: 0.0371 Test: 0.1007 lr: 0.0914 FPS: 55154 
Epoch: 020 Loss: 0.094327 Train: 0.0362 Test: 0.1000 lr: 0.0905 FPS: 56151 
Epoch: 021 Loss: 0.087641 Train: 0.0332 Test: 0.0980 lr: 0.0895 FPS: 55035 
Epoch: 022 Loss: 0.088478 Train: 0.0329 Test: 0.1045 lr: 0.0885 FPS: 55663 
Epoch: 023 Loss: 0.077843 Train: 0.0295 Test: 0.1025 lr: 0.0875 FPS: 55343 
Epoch: 024 Loss: 0.076491 Train: 0.0285 Test: 0.0954 lr: 0.0864 FPS: 54780 B 
Epoch: 025 Loss: 0.072690 Train: 0.0274 Test: 0.0979 lr: 0.0854 FPS: 55809 
Epoch: 026 Loss: 0.063749 Train: 0.0238 Test: 0.1040 lr: 0.0842 FPS: 55628 
Epoch: 027 Loss: 0.061651 Train: 0.0230 Test: 0.0979 lr: 0.0831 FPS: 55240 
Epoch: 028 Loss: 0.054112 Train: 0.0197 Test: 0.0960 lr: 0.0819 FPS: 55447 
Epoch: 029 Loss: 0.049342 Train: 0.0181 Test: 0.0966 lr: 0.0806 FPS: 55954 
Epoch: 030 Loss: 0.046436 Train: 0.0168 Test: 0.0950 lr: 0.0794 FPS: 54234 B 
Epoch: 031 Loss: 0.043349 Train: 0.0161 Test: 0.0947 lr: 0.0781 FPS: 55421 B 
Epoch: 032 Loss: 0.035410 Train: 0.0124 Test: 0.0943 lr: 0.0768 FPS: 55538 B 
Epoch: 033 Loss: 0.033811 Train: 0.0119 Test: 0.0934 lr: 0.0755 FPS: 54958 B 
Epoch: 034 Loss: 0.031696 Train: 0.0110 Test: 0.0969 lr: 0.0741 FPS: 55361 
Epoch: 035 Loss: 0.032079 Train: 0.0109 Test: 0.0925 lr: 0.0727 FPS: 55303 B 
Epoch: 036 Loss: 0.023883 Train: 0.0082 Test: 0.0896 lr: 0.0713 FPS: 55635 B 
Epoch: 037 Loss: 0.018632 Train: 0.0057 Test: 0.0874 lr: 0.0699 FPS: 55863 B 
Epoch: 038 Loss: 0.017087 Train: 0.0053 Test: 0.0910 lr: 0.0684 FPS: 55493 
Epoch: 039 Loss: 0.014062 Train: 0.0040 Test: 0.0882 lr: 0.0669 FPS: 55677 
Epoch: 040 Loss: 0.009961 Train: 0.0025 Test: 0.0895 lr: 0.0655 FPS: 54959 
Epoch: 041 Loss: 0.007707 Train: 0.0015 Test: 0.0865 lr: 0.0639 FPS: 55949 B 
Epoch: 042 Loss: 0.004687 Train: 0.0005 Test: 0.0845 lr: 0.0624 FPS: 55052 B 
Epoch: 043 Loss: 0.002928 Train: 0.0001 Test: 0.0841 lr: 0.0609 FPS: 55758 B 
Epoch: 044 Loss: 0.002366 Train: 0.0000 Test: 0.0835 lr: 0.0594 FPS: 55695 B 
Epoch: 045 Loss: 0.002507 Train: 0.0000 Test: 0.0837 lr: 0.0578 FPS: 55597 
Epoch: 046 Loss: 0.002588 Train: 0.0000 Test: 0.0829 lr: 0.0563 FPS: 55883 B 
Epoch: 047 Loss: 0.002777 Train: 0.0000 Test: 0.0835 lr: 0.0547 FPS: 55285 
Epoch: 048 Loss: 0.003036 Train: 0.0000 Test: 0.0827 lr: 0.0531 FPS: 55828 B 
Epoch: 049 Loss: 0.003211 Train: 0.0000 Test: 0.0828 lr: 0.0516 FPS: 55389 
Epoch: 050 Loss: 0.003334 Train: 0.0000 Test: 0.0844 lr: 0.0500 FPS: 54727 
Epoch: 051 Loss: 0.003511 Train: 0.0000 Test: 0.0842 lr: 0.0484 FPS: 55766 
Epoch: 052 Loss: 0.003585 Train: 0.0000 Test: 0.0850 lr: 0.0469 FPS: 55140 
Epoch: 053 Loss: 0.003589 Train: 0.0000 Test: 0.0829 lr: 0.0453 FPS: 56130 
Epoch: 054 Loss: 0.003572 Train: 0.0000 Test: 0.0838 lr: 0.0437 FPS: 55228 
Epoch: 055 Loss: 0.003583 Train: 0.0000 Test: 0.0827 lr: 0.0422 FPS: 55604 
Epoch: 056 Loss: 0.003584 Train: 0.0000 Test: 0.0839 lr: 0.0406 FPS: 55708 
Epoch: 057 Loss: 0.003608 Train: 0.0000 Test: 0.0844 lr: 0.0391 FPS: 55338 
Epoch: 058 Loss: 0.003677 Train: 0.0000 Test: 0.0838 lr: 0.0376 FPS: 55737 
Epoch: 059 Loss: 0.003694 Train: 0.0000 Test: 0.0832 lr: 0.0361 FPS: 54827 
Epoch: 060 Loss: 0.003725 Train: 0.0000 Test: 0.0846 lr: 0.0345 FPS: 55804 
Epoch: 061 Loss: 0.003527 Train: 0.0000 Test: 0.0842 lr: 0.0331 FPS: 55230 
Epoch: 062 Loss: 0.003615 Train: 0.0000 Test: 0.0836 lr: 0.0316 FPS: 55168 
Epoch: 063 Loss: 0.003511 Train: 0.0000 Test: 0.0836 lr: 0.0301 FPS: 55859 
Epoch: 064 Loss: 0.003543 Train: 0.0000 Test: 0.0836 lr: 0.0287 FPS: 55599 
Epoch: 065 Loss: 0.003464 Train: 0.0000 Test: 0.0840 lr: 0.0273 FPS: 55596 
Epoch: 066 Loss: 0.003516 Train: 0.0000 Test: 0.0850 lr: 0.0259 FPS: 55409 
Epoch: 067 Loss: 0.003449 Train: 0.0000 Test: 0.0850 lr: 0.0245 FPS: 55611 
Epoch: 068 Loss: 0.003433 Train: 0.0000 Test: 0.0850 lr: 0.0232 FPS: 54863 
Epoch: 069 Loss: 0.003425 Train: 0.0000 Test: 0.0839 lr: 0.0219 FPS: 55545 
Epoch: 070 Loss: 0.003408 Train: 0.0000 Test: 0.0839 lr: 0.0206 FPS: 55909 
Epoch: 071 Loss: 0.003392 Train: 0.0000 Test: 0.0846 lr: 0.0194 FPS: 55105 
Epoch: 072 Loss: 0.003345 Train: 0.0000 Test: 0.0833 lr: 0.0181 FPS: 55448 
Epoch: 073 Loss: 0.003377 Train: 0.0000 Test: 0.0846 lr: 0.0169 FPS: 55210 
Epoch: 074 Loss: 0.003357 Train: 0.0000 Test: 0.0839 lr: 0.0158 FPS: 55384 
Epoch: 075 Loss: 0.003308 Train: 0.0000 Test: 0.0848 lr: 0.0146 FPS: 55559 
Epoch: 076 Loss: 0.003284 Train: 0.0000 Test: 0.0839 lr: 0.0136 FPS: 55531 
Epoch: 077 Loss: 0.003321 Train: 0.0000 Test: 0.0846 lr: 0.0125 FPS: 55578 
Epoch: 078 Loss: 0.003278 Train: 0.0000 Test: 0.0846 lr: 0.0115 FPS: 54818 
Epoch: 079 Loss: 0.003263 Train: 0.0000 Test: 0.0848 lr: 0.0105 FPS: 55757 
Epoch: 080 Loss: 0.003235 Train: 0.0000 Test: 0.0851 lr: 0.0095 FPS: 55204 
Epoch: 081 Loss: 0.003258 Train: 0.0000 Test: 0.0853 lr: 0.0086 FPS: 55231 
Epoch: 082 Loss: 0.003227 Train: 0.0000 Test: 0.0840 lr: 0.0078 FPS: 55642 
Epoch: 083 Loss: 0.003199 Train: 0.0000 Test: 0.0851 lr: 0.0070 FPS: 55536 
Epoch: 084 Loss: 0.003192 Train: 0.0000 Test: 0.0848 lr: 0.0062 FPS: 55681 
Epoch: 085 Loss: 0.003208 Train: 0.0000 Test: 0.0854 lr: 0.0054 FPS: 55187 
Epoch: 086 Loss: 0.003201 Train: 0.0000 Test: 0.0849 lr: 0.0048 FPS: 55596 
Epoch: 087 Loss: 0.003172 Train: 0.0000 Test: 0.0851 lr: 0.0041 FPS: 55594 
Epoch: 088 Loss: 0.003139 Train: 0.0000 Test: 0.0842 lr: 0.0035 FPS: 55211 
Epoch: 089 Loss: 0.003149 Train: 0.0000 Test: 0.0849 lr: 0.0030 FPS: 55138 
Epoch: 090 Loss: 0.003151 Train: 0.0000 Test: 0.0848 lr: 0.0024 FPS: 55197 
Epoch: 091 Loss: 0.003120 Train: 0.0000 Test: 0.0847 lr: 0.0020 FPS: 55934 
Epoch: 092 Loss: 0.003133 Train: 0.0000 Test: 0.0850 lr: 0.0016 FPS: 55145 
Epoch: 093 Loss: 0.003106 Train: 0.0000 Test: 0.0851 lr: 0.0012 FPS: 55696 
Epoch: 094 Loss: 0.003119 Train: 0.0000 Test: 0.0848 lr: 0.0009 FPS: 55182 
Epoch: 095 Loss: 0.003093 Train: 0.0000 Test: 0.0846 lr: 0.0006 FPS: 54814 
Epoch: 096 Loss: 0.003110 Train: 0.0000 Test: 0.0846 lr: 0.0004 FPS: 55534 
Epoch: 097 Loss: 0.003092 Train: 0.0000 Test: 0.0846 lr: 0.0002 FPS: 54994 
Epoch: 098 Loss: 0.003068 Train: 0.0000 Test: 0.0844 lr: 0.0001 FPS: 55641 
Epoch: 099 Loss: 0.003090 Train: 0.0000 Test: 0.0844 lr: 0.0000 FPS: 55093 
----------------------------------------------------------------------------------------------------
Optimization ended at 19-04-13 11:29:10
