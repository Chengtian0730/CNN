----------------------------------------------------------------------------------------------------
18-11-29 10:24:11
SEED = 1543458251
----------------------------------------------------------------------------------------------------
Options are printed as follows:
title = 'temp'
mode = 'train'  # 'train', 'test', 'restart', 'debug', 'export', 'input_train', 'input_test', 'speed_net'
seed = None
gpu_list = [3]
batch_size = 128
dataset = 'mnist'  # 'mnist', 'fashion'
preprocess = 'mnist'  # 'mnist'
network = 'mlp'  # 'mlp', 'lenet'
path_load = None
path_save = None
l2_decay = {'decay': 0, 'exclude': []}
epoch_step = tf.Variable(1, name='epoch_step', trainable=False)
learning_step = tf.Variable(0, name='learning_step', trainable=False)
lr_decay = tf.train.cosine_decay(0.5, epoch_step, decay_steps=100)  # cifar cosine
loss_func = tf.losses.mean_squared_error
optimizer = tf.train.MomentumOptimizer(lr_decay, momentum=0.)
----------------------------------------------------------------------------------------------------
Single-GPU training with gpu 3
All parameters are pinned to GPU, all Ops are pinned to GPU
Training model on GPU 3
Input data format is NHWC, convert to NCHW
/device:GPU:3 fc0/fc0_1 [784, 256]
/device:GPU:3 fc_last/fc_last_1 [256, 10]
Parameters: 203264 {'fc': 203264}
MACs: 203264
No L2 weight decay
Testing model on GPU 3
Input data format is NHWC, convert to NCHW
----------------------------------------------------------------------------------------------------
Epoch: 001 Loss: 0.038196 Train: 0.1459 Test: 0.0771 lr: 0.4999 FPS: 22495 
Epoch: 002 Loss: 0.021010 Train: 0.0719 Test: 0.0618 lr: 0.4995 FPS: 28365 B 
Epoch: 003 Loss: 0.017879 Train: 0.0604 Test: 0.0541 lr: 0.4989 FPS: 28817 B 
Epoch: 004 Loss: 0.016151 Train: 0.0529 Test: 0.0498 lr: 0.4980 FPS: 28771 B 
Epoch: 005 Loss: 0.014964 Train: 0.0481 Test: 0.0465 lr: 0.4969 FPS: 28592 B 
Epoch: 006 Loss: 0.014076 Train: 0.0446 Test: 0.0425 lr: 0.4956 FPS: 28327 B 
Epoch: 007 Loss: 0.013393 Train: 0.0418 Test: 0.0412 lr: 0.4940 FPS: 28853 B 
Epoch: 008 Loss: 0.012805 Train: 0.0390 Test: 0.0408 lr: 0.4921 FPS: 28663 B 
Epoch: 009 Loss: 0.012302 Train: 0.0364 Test: 0.0393 lr: 0.4901 FPS: 28277 B 
Epoch: 010 Loss: 0.011923 Train: 0.0359 Test: 0.0374 lr: 0.4878 FPS: 28343 B 
Epoch: 011 Loss: 0.011513 Train: 0.0336 Test: 0.0354 lr: 0.4852 FPS: 28717 B 
Epoch: 012 Loss: 0.011247 Train: 0.0329 Test: 0.0342 lr: 0.4824 FPS: 28420 B 
Epoch: 013 Loss: 0.010929 Train: 0.0317 Test: 0.0343 lr: 0.4794 FPS: 28453 
Epoch: 014 Loss: 0.010669 Train: 0.0303 Test: 0.0334 lr: 0.4762 FPS: 28518 B 
Epoch: 015 Loss: 0.010447 Train: 0.0298 Test: 0.0338 lr: 0.4728 FPS: 28846 
Epoch: 016 Loss: 0.010232 Train: 0.0289 Test: 0.0327 lr: 0.4691 FPS: 28524 B 
Epoch: 017 Loss: 0.010037 Train: 0.0279 Test: 0.0329 lr: 0.4652 FPS: 28321 
Epoch: 018 Loss: 0.009835 Train: 0.0271 Test: 0.0316 lr: 0.4611 FPS: 28555 B 
Epoch: 019 Loss: 0.009708 Train: 0.0264 Test: 0.0311 lr: 0.4568 FPS: 28416 B 
Epoch: 020 Loss: 0.009539 Train: 0.0260 Test: 0.0318 lr: 0.4523 FPS: 28466 
Epoch: 021 Loss: 0.009390 Train: 0.0247 Test: 0.0305 lr: 0.4475 FPS: 28369 B 
Epoch: 022 Loss: 0.009287 Train: 0.0249 Test: 0.0303 lr: 0.4426 FPS: 28428 B 
Epoch: 023 Loss: 0.009135 Train: 0.0243 Test: 0.0294 lr: 0.4375 FPS: 28648 B 
Epoch: 024 Loss: 0.009043 Train: 0.0238 Test: 0.0305 lr: 0.4322 FPS: 28530 
Epoch: 025 Loss: 0.008910 Train: 0.0235 Test: 0.0298 lr: 0.4268 FPS: 28779 
Epoch: 026 Loss: 0.008848 Train: 0.0233 Test: 0.0289 lr: 0.4211 FPS: 29019 B 
Epoch: 027 Loss: 0.008714 Train: 0.0226 Test: 0.0295 lr: 0.4153 FPS: 28581 
Epoch: 028 Loss: 0.008629 Train: 0.0222 Test: 0.0291 lr: 0.4094 FPS: 28459 
Epoch: 029 Loss: 0.008587 Train: 0.0224 Test: 0.0292 lr: 0.4032 FPS: 28476 
Epoch: 030 Loss: 0.008449 Train: 0.0215 Test: 0.0284 lr: 0.3969 FPS: 28790 B 
Epoch: 031 Loss: 0.008395 Train: 0.0215 Test: 0.0281 lr: 0.3905 FPS: 28697 B 
Epoch: 032 Loss: 0.008289 Train: 0.0207 Test: 0.0281 lr: 0.3840 FPS: 28634 
Epoch: 033 Loss: 0.008254 Train: 0.0209 Test: 0.0284 lr: 0.3773 FPS: 29123 
Epoch: 034 Loss: 0.008166 Train: 0.0204 Test: 0.0276 lr: 0.3704 FPS: 28803 B 
Epoch: 035 Loss: 0.008104 Train: 0.0201 Test: 0.0277 lr: 0.3635 FPS: 28647 
Epoch: 036 Loss: 0.008054 Train: 0.0201 Test: 0.0285 lr: 0.3564 FPS: 29077 
Epoch: 037 Loss: 0.007983 Train: 0.0198 Test: 0.0279 lr: 0.3493 FPS: 29016 
Epoch: 038 Loss: 0.007944 Train: 0.0196 Test: 0.0274 lr: 0.3420 FPS: 28697 B 
Epoch: 039 Loss: 0.007888 Train: 0.0196 Test: 0.0270 lr: 0.3347 FPS: 28573 B 
Epoch: 040 Loss: 0.007800 Train: 0.0189 Test: 0.0271 lr: 0.3273 FPS: 28819 
Epoch: 041 Loss: 0.007797 Train: 0.0191 Test: 0.0272 lr: 0.3197 FPS: 28246 
Epoch: 042 Loss: 0.007731 Train: 0.0190 Test: 0.0269 lr: 0.3122 FPS: 28712 B 
Epoch: 043 Loss: 0.007721 Train: 0.0190 Test: 0.0274 lr: 0.3045 FPS: 28716 
Epoch: 044 Loss: 0.007619 Train: 0.0182 Test: 0.0270 lr: 0.2968 FPS: 28597 
Epoch: 045 Loss: 0.007615 Train: 0.0184 Test: 0.0272 lr: 0.2891 FPS: 28642 
Epoch: 046 Loss: 0.007555 Train: 0.0183 Test: 0.0264 lr: 0.2813 FPS: 28486 B 
Epoch: 047 Loss: 0.007514 Train: 0.0181 Test: 0.0270 lr: 0.2735 FPS: 28644 
Epoch: 048 Loss: 0.007482 Train: 0.0178 Test: 0.0264 lr: 0.2657 FPS: 28617 B 
Epoch: 049 Loss: 0.007470 Train: 0.0180 Test: 0.0263 lr: 0.2579 FPS: 28142 B 
Epoch: 050 Loss: 0.007409 Train: 0.0179 Test: 0.0271 lr: 0.2500 FPS: 28384 
Epoch: 051 Loss: 0.007405 Train: 0.0176 Test: 0.0267 lr: 0.2421 FPS: 28871 
Epoch: 052 Loss: 0.007344 Train: 0.0174 Test: 0.0266 lr: 0.2343 FPS: 28329 
Epoch: 053 Loss: 0.007342 Train: 0.0173 Test: 0.0264 lr: 0.2265 FPS: 28665 
Epoch: 054 Loss: 0.007334 Train: 0.0178 Test: 0.0260 lr: 0.2187 FPS: 28420 B 
Epoch: 055 Loss: 0.007264 Train: 0.0174 Test: 0.0261 lr: 0.2109 FPS: 28936 
Epoch: 056 Loss: 0.007218 Train: 0.0167 Test: 0.0267 lr: 0.2032 FPS: 28448 
Epoch: 057 Loss: 0.007226 Train: 0.0173 Test: 0.0259 lr: 0.1955 FPS: 28431 B 
Epoch: 058 Loss: 0.007213 Train: 0.0172 Test: 0.0262 lr: 0.1878 FPS: 28829 
Epoch: 059 Loss: 0.007170 Train: 0.0166 Test: 0.0258 lr: 0.1803 FPS: 28825 B 
Epoch: 060 Loss: 0.007159 Train: 0.0168 Test: 0.0257 lr: 0.1727 FPS: 28030 B 
Epoch: 061 Loss: 0.007140 Train: 0.0165 Test: 0.0258 lr: 0.1653 FPS: 28601 
Epoch: 062 Loss: 0.007122 Train: 0.0169 Test: 0.0260 lr: 0.1580 FPS: 28750 
Epoch: 063 Loss: 0.007100 Train: 0.0164 Test: 0.0260 lr: 0.1507 FPS: 28478 
Epoch: 064 Loss: 0.007087 Train: 0.0166 Test: 0.0261 lr: 0.1436 FPS: 28469 
Epoch: 065 Loss: 0.007059 Train: 0.0163 Test: 0.0257 lr: 0.1365 FPS: 28540 B 
Epoch: 066 Loss: 0.007045 Train: 0.0164 Test: 0.0257 lr: 0.1296 FPS: 28828 
Epoch: 067 Loss: 0.007067 Train: 0.0164 Test: 0.0254 lr: 0.1227 FPS: 28634 B 
Epoch: 068 Loss: 0.007002 Train: 0.0161 Test: 0.0260 lr: 0.1160 FPS: 28420 
Epoch: 069 Loss: 0.006985 Train: 0.0162 Test: 0.0257 lr: 0.1095 FPS: 28928 
Epoch: 070 Loss: 0.007011 Train: 0.0164 Test: 0.0254 lr: 0.1031 FPS: 28908 B 
Epoch: 071 Loss: 0.006970 Train: 0.0159 Test: 0.0260 lr: 0.0968 FPS: 28646 
Epoch: 072 Loss: 0.006999 Train: 0.0165 Test: 0.0262 lr: 0.0906 FPS: 28457 
Epoch: 073 Loss: 0.006959 Train: 0.0161 Test: 0.0256 lr: 0.0847 FPS: 29200 
Epoch: 074 Loss: 0.006946 Train: 0.0158 Test: 0.0259 lr: 0.0789 FPS: 28659 
Epoch: 075 Loss: 0.006928 Train: 0.0160 Test: 0.0254 lr: 0.0732 FPS: 28593 
Epoch: 076 Loss: 0.006932 Train: 0.0160 Test: 0.0255 lr: 0.0678 FPS: 28752 
Epoch: 077 Loss: 0.006946 Train: 0.0162 Test: 0.0256 lr: 0.0625 FPS: 28873 
Epoch: 078 Loss: 0.006937 Train: 0.0160 Test: 0.0254 lr: 0.0574 FPS: 28463 
Epoch: 079 Loss: 0.006878 Train: 0.0157 Test: 0.0257 lr: 0.0525 FPS: 28346 
Epoch: 080 Loss: 0.006920 Train: 0.0158 Test: 0.0256 lr: 0.0477 FPS: 29256 
Epoch: 081 Loss: 0.006900 Train: 0.0160 Test: 0.0257 lr: 0.0432 FPS: 28811 
Epoch: 082 Loss: 0.006865 Train: 0.0156 Test: 0.0255 lr: 0.0389 FPS: 28140 
Epoch: 083 Loss: 0.006919 Train: 0.0161 Test: 0.0255 lr: 0.0348 FPS: 28424 
Epoch: 084 Loss: 0.006871 Train: 0.0156 Test: 0.0257 lr: 0.0309 FPS: 28629 
Epoch: 085 Loss: 0.006876 Train: 0.0160 Test: 0.0254 lr: 0.0272 FPS: 28137 
Epoch: 086 Loss: 0.006864 Train: 0.0157 Test: 0.0255 lr: 0.0238 FPS: 28503 
Epoch: 087 Loss: 0.006873 Train: 0.0159 Test: 0.0255 lr: 0.0206 FPS: 28996 
Epoch: 088 Loss: 0.006897 Train: 0.0155 Test: 0.0256 lr: 0.0176 FPS: 29111 
Epoch: 089 Loss: 0.006872 Train: 0.0160 Test: 0.0254 lr: 0.0148 FPS: 28419 
Epoch: 090 Loss: 0.006844 Train: 0.0157 Test: 0.0256 lr: 0.0122 FPS: 28564 
Epoch: 091 Loss: 0.006838 Train: 0.0154 Test: 0.0255 lr: 0.0099 FPS: 28736 
Epoch: 092 Loss: 0.006887 Train: 0.0159 Test: 0.0254 lr: 0.0079 FPS: 28280 
Epoch: 093 Loss: 0.006866 Train: 0.0159 Test: 0.0256 lr: 0.0060 FPS: 28139 
Epoch: 094 Loss: 0.006859 Train: 0.0157 Test: 0.0255 lr: 0.0044 FPS: 28425 
Epoch: 095 Loss: 0.006860 Train: 0.0158 Test: 0.0254 lr: 0.0031 FPS: 28841 
Epoch: 096 Loss: 0.006874 Train: 0.0159 Test: 0.0255 lr: 0.0020 FPS: 28513 
Epoch: 097 Loss: 0.006857 Train: 0.0157 Test: 0.0255 lr: 0.0011 FPS: 28535 
Epoch: 098 Loss: 0.006841 Train: 0.0156 Test: 0.0255 lr: 0.0005 FPS: 28681 
Epoch: 099 Loss: 0.006845 Train: 0.0156 Test: 0.0255 lr: 0.0001 FPS: 28324 
----------------------------------------------------------------------------------------------------
Optimization ended at 18-11-29 10:28:08
